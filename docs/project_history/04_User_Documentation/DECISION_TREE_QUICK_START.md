# 智能決策樹 - 快速開始指南

**版本**: v1.0  
**最後更新**: 2026-02-04

---

## 🚀 快速開始

### 1. 上傳數據
- 點擊「Select Data Files」上傳 Excel 文件
- 選擇零件 (Part Number)
- 選擇檢驗項目 (Inspection Item)

### 2. 開啟決策嚮導
- 點擊「🧭 開啟智能決策嚮導」按鈕
- 系統將自動分析您的數據

### 3. 完成 5 層決策
按照嚮導逐層完成決策：

#### 第 1 層：數據類型判斷
- 系統自動檢測您的數據類型
- 顯示推薦的圖表類型

#### 第 2 層：樣本數分析
- 系統檢測每批次的樣本數
- 根據 n 值推薦最適合的圖表

#### 第 3 層：常態性檢驗
- 執行 Shapiro-Wilk 檢驗
- 顯示 P-value 和建議

#### 第 4 層：趨勢檢測
- 檢測製程是否有趨勢
- 識別磨耗或漂移

#### 第 5 層：敏感度選擇
- 選擇監測敏感度
- 標準 / 中等 / 高敏感

### 4. 開始分析
- 點擊「開始分析」按鈕
- 系統自動選擇推薦的圖表類型
- 執行完整分析

---

## 📊 決策邏輯速查表

### 數據類型判斷

| 數據特徵 | 類型 | 推薦圖表 |
|---------|------|---------|
| 連續測量值 (mm, μm, g) | 計量型 | I-MR, X-bar/R, X-bar/S |
| 良/不良二元分類 | 計數型 (二元) | P Chart, NP Chart |
| 缺陷數計數 | 計數型 (多元) | C Chart, U Chart |

### 樣本數推薦

| 樣本數 | 分類 | 推薦圖表 | 理由 |
|--------|------|---------|------|
| n = 1 | 個別值 | I-MR | 個別值監測 |
| 2 ≤ n ≤ 5 | 小樣本 | X-bar/R | 使用 R 估計 σ |
| 6 ≤ n ≤ 10 | 中樣本 | X-bar/S | 使用 S 估計 σ |
| n > 10 | 大樣本 | X-bar/S | 最精確估計 |

### 常態性檢驗結果

| P-value | 結論 | 建議 |
|---------|------|------|
| ≥ 0.05 | ✓ 符合常態分布 | 使用標準 Shewhart 圖表 |
| < 0.05 | ✗ 不符合常態分布 | 嘗試數據轉換或非參數方法 |

### 趨勢檢測結果

| 趨勢類型 | 特徵 | 推薦 |
|---------|------|------|
| 無趨勢 | R² ≤ 0.7 | 標準 Shewhart 管制圖 |
| 磨耗趨勢 | R² > 0.7, slope < 0 | 允收管制圖 |
| 漂移趨勢 | R² > 0.7, slope > 0 | 擴展 Shewhart 或 EWMA |

### 敏感度選擇

| 敏感度 | 方法 | 特點 | 適用 |
|--------|------|------|------|
| 標準 | Shewhart | 傳統、易理解 | 一般監測 |
| 中等 | EWMA | 對小變化敏感 | 快速反應 |
| 高敏感 | CUSUM | 最敏感 | 精密製造 |

---

## 💡 常見問題

### Q1: 我可以跳過決策嚮導嗎？
**A**: 是的。點擊「跳過嚮導」按鈕可以直接選擇圖表類型。

### Q2: 如果我不同意推薦怎麼辦？
**A**: 您可以在推薦後手動選擇其他圖表類型。決策嚮導只是建議，不是強制。

### Q3: 決策嚮導需要多長時間？
**A**: 通常 1-2 分鐘。取決於數據量和您的選擇速度。

### Q4: 如果數據不符合常態分布怎麼辦？
**A**: 系統會建議數據轉換 (Log、Box-Cox、平方根) 或使用非參數方法。

### Q5: 什麼是「敏感度」？
**A**: 敏感度決定了圖表對製程變化的反應速度。高敏感度能檢測微小變化，但可能增加誤報。

---

## 🎯 使用場景

### 場景 1：多穴模具 (計量型)

**數據**: 4 穴模具，每批次 4 個測量值

**決策過程**:
1. 第 1 層: 檢測到計量型 ✓
2. 第 2 層: n = 4 → 推薦 X-bar/R ✓
3. 第 3 層: P-value = 0.23 → 符合常態分布 ✓
4. 第 4 層: R² = 0.15 → 無趨勢 ✓
5. 第 5 層: 選擇「標準」敏感度 ✓

**結果**: X-bar/R Chart

---

### 場景 2：不良率監測 (計數型)

**數據**: 每批次 100 件，記錄良/不良

**決策過程**:
1. 第 1 層: 檢測到二元計數 ✓
2. 第 2 層: n = 100 → 確認 P Chart ✓
3. 第 3 層: 不適用 (計數型) ✓
4. 第 4 層: 檢測到不良率上升 ⚠
5. 第 5 層: 選擇「中等」敏感度 ✓

**結果**: P Chart (EWMA 變體)

---

### 場景 3：缺陷計數 (計數型)

**數據**: 每件產品的缺陷數

**決策過程**:
1. 第 1 層: 檢測到多元計數 ✓
2. 第 2 層: n = 1 → 確認 C Chart ✓
3. 第 3 層: 不適用 (計數型) ✓
4. 第 4 層: 無明顯趨勢 ✓
5. 第 5 層: 選擇「標準」敏感度 ✓

**結果**: C Chart

---

## 📚 進階用法

### 手動覆蓋推薦

如果您不同意系統推薦：

1. 完成決策嚮導
2. 在推薦摘要中點擊「關閉」
3. 在「Analysis Type」下拉菜單中手動選擇
4. 點擊「Generate Analysis」

### 查看詳細結果

每層決策都顯示詳細信息：

- **第 1 層**: 數據類型和推薦圖表
- **第 2 層**: 樣本數分析和推薦理由
- **第 3 層**: Shapiro-Wilk P-value 和轉換建議
- **第 4 層**: 線性斜率、R² 值和趨勢強度
- **第 5 層**: 敏感度選項和特點

### 重新運行決策嚮導

如果您想重新分析：

1. 點擊「Reset」清除所有選擇
2. 重新上傳或選擇數據
3. 再次點擊「🧭 開啟智能決策嚮導」

---

## 🔧 技術細節

### 決策邏輯引擎

**文件**: `frontend/src/utils/decision_logic.js`

**主要函數**:
- `detectDataType(data)` - 檢測數據類型
- `analyzeSampleSize(n)` - 分析樣本數
- `testNormality(data)` - Shapiro-Wilk 檢驗
- `detectTrend(data)` - 線性回歸趨勢檢測
- `recommendChartType(context)` - 主推薦引擎

### 決策嚮導 UI

**文件**: `frontend/src/components/DecisionWizard.jsx`

**組件**:
- `DecisionWizard` - 主組件
- `Layer1DataType` - 第 1 層 UI
- `Layer2SampleSize` - 第 2 層 UI
- `Layer3Normality` - 第 3 層 UI
- `Layer4Trend` - 第 4 層 UI
- `Layer5Sensitivity` - 第 5 層 UI

### 集成點

**文件**: `frontend/src/App.jsx`

**修改**:
- 導入 `DecisionWizard` 組件
- 添加 `showDecisionWizard` 和 `wizardRecommendation` 狀態
- 添加 `handleWizardRecommendation()` 和 `handleWizardSkip()` 回調
- 在 UI 中顯示決策嚮導和推薦摘要

---

## 📞 支持

### 遇到問題？

1. **決策嚮導不顯示**
   - 確保已選擇零件和檢驗項目
   - 確保已上傳 Excel 文件

2. **推薦結果不合理**
   - 檢查數據是否有異常值
   - 查看詳細的決策過程

3. **無法手動選擇圖表**
   - 關閉推薦摘要
   - 在「Analysis Type」下拉菜單中選擇

---

## 📖 相關文檔

- `DECISION_TREE_IMPLEMENTATION_PLAN.md` - 實現計劃
- `DECISION_TREE_PHASE_4_REPORT.md` - 完成報告
- `USER_GUIDANCE_SYSTEM.md` - 用戶指導系統
- `CONTROL_CHART_EVALUATION.md` - 圖表類型評估

---

**祝您使用愉快！** 🎉

