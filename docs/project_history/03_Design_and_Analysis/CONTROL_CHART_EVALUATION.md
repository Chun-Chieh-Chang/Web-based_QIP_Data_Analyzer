# 管制圖類型評估報告

**評估日期**: 2026-02-04  
**評估者**: Kiro AI Assistant  
**項目**: Web-based QIP Data Analyzer

---

## 執行摘要

**建議**: ✅ **應該增加管制圖類型**

當前應用僅支持 **I-MR 圖** (個別值-移動全距圖)，這對多穴模具分析有限制。建議增加以下圖表類型以提升應用的通用性和專業性。

---

## 1. 當前管制圖實現狀況

### 已實現的圖表類型

| 圖表類型 | 狀態 | 說明 |
|---------|------|------|
| **I-MR 圖** (Individuals-Moving Range) | ✅ 已實現 | 批次平均值 (X-bar) 與全距 (R) 圖 |
| **Z-Chart** (標準化圖表) | ✅ 已實現 | 標準化後的 Z 分數圖 |
| **Cavity Comparison** | ✅ 已實現 | 多穴對比分析 |
| **Group Trend** | ✅ 已實現 | 最小-最大-平均趨勢 |

### 當前限制

1. **缺乏 X-bar/S 圖**: 無法監測標準差變化
2. **缺乏 P 圖/NP 圖**: 無法進行不良率分析
3. **缺乏 C 圖/U 圖**: 無法進行缺陷數分析
4. **缺乏 EWMA 圖**: 無法進行指數加權移動平均分析
5. **缺乏 Cusum 圖**: 無法進行累積和分析

---

## 2. 建議增加的管制圖類型

### 優先級 1: 高度推薦 (立即實現)

#### 2.1 X-bar/S 圖 (X-bar/Sigma Chart)

**適用場景**:
- 多穴模具分析 (n ≥ 3)
- 需要同時監測中心和變異

**優勢**:
- 比 I-MR 圖更敏感
- 適合多穴數據
- 業界標準

**實現難度**: ⭐⭐ (中等)

**計算公式**:
```
X-bar = 平均值
S = 標準差
UCL_X = X-bar + A3 × S-bar
LCL_X = X-bar - A3 × S-bar
UCL_S = B4 × S-bar
LCL_S = B3 × S-bar
```

**預期工作量**: 4-6 小時

---

#### 2.2 P 圖 (Proportion Defective Chart)

**適用場景**:
- 不良品率監測
- 抽樣檢驗數據
- 良/不良二元分類

**優勢**:
- 適合品質管理
- 易於理解
- 廣泛應用

**實現難度**: ⭐⭐ (中等)

**計算公式**:
```
p = 不良品數 / 樣本數
UCL = p + 3√[p(1-p)/n]
LCL = p - 3√[p(1-p)/n]
```

**預期工作量**: 3-5 小時

---

### 優先級 2: 中度推薦 (後續實現)

#### 2.3 C 圖 (Count Chart)

**適用場景**:
- 缺陷數監測
- 單位產品缺陷計數
- 不符合項目計數

**優勢**:
- 適合缺陷分析
- 泊松分布基礎
- 品質改善追蹤

**實現難度**: ⭐⭐ (中等)

**計算公式**:
```
c = 平均缺陷數
UCL = c + 3√c
LCL = c - 3√c
```

**預期工作量**: 3-4 小時

---

#### 2.4 EWMA 圖 (Exponentially Weighted Moving Average)

**適用場景**:
- 長期趨勢監測
- 小變化檢測
- 過程漂移檢測

**優勢**:
- 對小變化敏感
- 適合連續監測
- 現代 SPC 標準

**實現難度**: ⭐⭐⭐ (較難)

**計算公式**:
```
EWMA_t = λ × X_t + (1-λ) × EWMA_{t-1}
UCL = μ + L × σ × √[λ/(2-λ)]
LCL = μ - L × σ × √[λ/(2-λ)]
```

**預期工作量**: 6-8 小時

---

### 優先級 3: 可選 (未來考慮)

#### 2.5 Cusum 圖 (Cumulative Sum Control Chart)

**適用場景**:
- 累積偏差監測
- 長期漂移檢測
- 精密過程控制

**優勢**:
- 高度敏感
- 適合精密製造
- 國際標準

**實現難度**: ⭐⭐⭐⭐ (困難)

**預期工作量**: 8-10 小時

---

## 3. 實現優先順序建議

### 第一階段 (立即實現)
1. **X-bar/S 圖** - 最實用，多穴模具必需
2. **P 圖** - 品質管理基礎

### 第二階段 (1-2 個月)
3. **C 圖** - 缺陷分析補充
4. **EWMA 圖** - 高級監測功能

### 第三階段 (未來)
5. **Cusum 圖** - 專業級功能

---

## 4. 技術實現評估

### 架構影響

**當前架構**:
```
App.jsx (UI)
  ↓
spc_logic.js (計算)
  ↓
spc.worker.js (後台處理)
```

**影響範圍**:
- ✅ 最小化 UI 改動
- ✅ 主要在 spc_logic.js 中添加計算
- ✅ 無需修改 worker 架構

### 代碼複雜度

| 圖表類型 | 複雜度 | 代碼行數 | 測試工作量 |
|---------|--------|---------|-----------|
| X-bar/S | 中等 | 150-200 | 中等 |
| P 圖 | 低 | 80-120 | 低 |
| C 圖 | 低 | 80-120 | 低 |
| EWMA | 高 | 200-250 | 高 |
| Cusum | 高 | 250-300 | 高 |

---

## 5. 用戶需求分析

### 當前用戶場景

基於應用設計，主要用戶是:
- 多穴模具製造商
- 品質工程師
- 製程改善團隊

### 用戶需求

| 需求 | 優先級 | 當前支持 | 建議 |
|------|--------|---------|------|
| 中心監測 | 🔴 高 | ✅ | 保持 |
| 變異監測 | 🔴 高 | ⚠️ 部分 | 增加 X-bar/S |
| 不良率監測 | 🟡 中 | ❌ | 增加 P 圖 |
| 缺陷監測 | 🟡 中 | ❌ | 增加 C 圖 |
| 趨勢分析 | 🟡 中 | ✅ | 增加 EWMA |

---

## 6. 成本效益分析

### 開發成本

| 項目 | 工作量 | 成本估算 |
|------|--------|---------|
| X-bar/S 圖 | 4-6 小時 | 中等 |
| P 圖 | 3-5 小時 | 低 |
| C 圖 | 3-4 小時 | 低 |
| EWMA 圖 | 6-8 小時 | 中等 |
| **總計** | **16-23 小時** | **中等** |

### 收益

| 收益 | 評分 |
|------|------|
| 功能完整性 | ⭐⭐⭐⭐⭐ |
| 用戶滿意度 | ⭐⭐⭐⭐ |
| 市場競爭力 | ⭐⭐⭐⭐ |
| 技術專業性 | ⭐⭐⭐⭐⭐ |

**ROI 評估**: ✅ 高度推薦

---

## 7. 實現路線圖

### 第 1 週: X-bar/S 圖
- 實現計算邏輯
- 添加 UI 選項
- 測試驗證

### 第 2 週: P 圖
- 實現計算邏輯
- 添加 UI 選項
- 測試驗證

### 第 3 週: C 圖 + EWMA 圖
- 實現兩種圖表
- 集成測試
- 文檔更新

### 第 4 週: 優化和發布
- 性能優化
- 用戶文檔
- GitHub 發布

---

## 8. 最終建議

### ✅ 應該增加管制圖類型

**理由**:

1. **功能完整性**: 當前缺乏變異和不良率監測
2. **用戶需求**: 多穴模具分析需要更多圖表類型
3. **技術可行性**: 現有架構支持擴展
4. **成本效益**: 工作量合理，收益顯著
5. **市場競爭**: 提升應用專業性和競爭力

### 優先實現順序

1. **X-bar/S 圖** (必需)
2. **P 圖** (推薦)
3. **C 圖** (推薦)
4. **EWMA 圖** (可選)

### 預期時間表

- **第一階段**: 2 週 (X-bar/S + P 圖)
- **第二階段**: 1 週 (C 圖 + EWMA)
- **總計**: 3 週

---

## 9. 風險評估

| 風險 | 可能性 | 影響 | 緩解措施 |
|------|--------|------|---------|
| 計算錯誤 | 低 | 高 | 完整單元測試 |
| 性能下降 | 低 | 中 | 優化計算邏輯 |
| UI 複雜度 | 中 | 中 | 漸進式添加功能 |
| 用戶困惑 | 低 | 低 | 完善文檔和教程 |

---

## 結論

**建議**: ✅ **立即開始實現 X-bar/S 圖和 P 圖**

這將顯著提升應用的功能完整性和專業性，滿足多穴模具製造商的核心需求。

---

**簽核**: Kiro AI Assistant  
**日期**: 2026-02-04  
**狀態**: 待批准

